



SIDR Operations                                                    K. Xu
Internet-Draft                                                   X. Wang
Intended status: Standards Track                                  Z. liu
Expires: 21 August 2025                                            L. Qi
                                                                   J. Wu
                                                     Tsinghua University
                                                        17 February 2025


                 Framework of Forwarding Commitment BGP
               draft-wang-sidrops-fcbgp-framework-latest

Abstract

   This document descibes a security framework based on Forwarding
   Commitment BGP(FC-BGP).  FC serves as a versatile and extensible
   verification primitive, seamlessly integrating with existing hop-by-
   hop forwarding architectures, using a chain-based verification
   mechanism to ensure both end-to-end authenticity and operational
   validity across Autonomous Systems (ASes).By combining topological
   information and operational actions, FC-based framework provides a
   foundation for robust inter-domain routing and forwarding security.

Discussion Venues

   This note is to be removed before publishing as an RFC.

   Discussion of this document takes place on the SIDR Operations
   mailing list (sidrops@ietf.org), which is archived at
   https://mailarchive.ietf.org/arch/browse/sidrops/.

   Source for this draft and an issue tracker can be found at
   https://github.com/FCBGP/framework-of-fcbgp.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 21 August 2025.

Copyright Notice

   Copyright (c) 2025 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Requirements Language
   2.  Role of FC in FC-based Framework
   3.  Forwarding Commitment
   4.  BGP Path Validation
   5.  Forwarding Validation
   6.  Security Considerations
     6.1.  Security Guarantees
   7.  IANA Considerations
   8.  Normative References
   Acknowledgments
   Authors' Addresses

1.  Introduction

   The Internet's routing and forwarding system relies on hop-by-hop
   mechanism to achieve global connectivity, providing significant
   scalability and flexibility.  However, this paradigm also introduces
   security challenges such as route hijacking and forwarding path
   manipulation.  The root cause lies in the mismatch between
   verification capabilities and information propagation range, which
   prevents end-to-end security while maintaining the flexibility of
   hop-by-hop processing.  Due to "indirect" nature of hop-by-hop
   mechanism, the authenticity and integrity of information cannot be
   verified.

   The existing representative mechanism BGPsec [RFC8205] aims to
   provide end-to-end verification by propagating onion-style signatures
   in BGP update messages.  Nevertheless, this design conflicts with
   Internet's distributed governance and hop-by-hop processing
   philosophy, resulting in substantial deployment hurdles.  Resource
   Public Key Infrastructure (RPKI) [RFC6480] is another key technology
   that reduces risk of route hijacking through cryptographic
   authentication of IP addresses and AS numbers, primarily by enabling
   Route Origin Validation (ROV).  However, RPKI mainly focuses on
   verifying route origins rather than path security.  Consequently,
   there is a lack of a unified and scalable verification mechanism.

   This document specifies a security framework based on Forwarding
   Commitment BGP(FC-BGP).  FC is a cryptographic signature code
   employed to validate an AS's routing intentions at its directly
   connected hop points.  The incrementally deployable framework based
   on a universal verification primitive FC, is designed to be
   compatible with existing hop-by-hop forwarding architectures, while
   overcoming the limitations of current verification capabilities.  By
   utilizing chain-based validation, it establishes an end-to-end
   verification mechanism across Autonomous Systems (ASes), ensuring
   authenticity and operational validity of information across ASes.
   This strategy enables enhanced trust propagation across the global
   Internet while maintaining the existing hop-by-hop forwarding
   paradigm, providing a secure and compatible framework to address the
   security dilemmas caused by mismatch between verification scope and
   information propagation range.

1.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.  Role of FC in FC-based Framework

   The key element of FC-BGP security framework is a transferable
   universal verification primitive-Forwarding Commitment (FC).  The
   goal of FC is to achieve end-to-end verification within routing and
   forwarding system while maintaining compatibility with hop-by-hop
   processing paradigm.

   +----+---+         +----+---+         +----+---+         +--------+
   |  AS A  +-------->+  AS B  +-------->+  AS C  +-------->+  AS D  |
   +----+---+  FC(A)  +----+---+  FC(A)  +----+---+  FC(A)  +----+---+
        ^                  ^      FC(B)       ^      FC(B)       ^
        |                  |                  |      FC(C)       |
        |                  |                  |                  |
        |                  |                  |                  |
      FC(A)              FC(B)              FC(C)              FC(D)

       Figure 1: Integration of FC with Routing and Forwarding Path.

   The integration of FC with routing and forwarding path is shown in
   Figure 1.  During hop-by-hop processing, each AS generates an FC
   based on its routing intent.  The FC provides a verifiable proof
   through cryptographic signatures, encapsulating routing behavior
   committed at directly connected hop, including information about
   previous hop AS, current AS, next hop AS and IP prefix, ensuring the
   authenticity and trustworthiness of provided routing information.
   Subsequent ASes receiving this information can verify FC from
   previous AS through a chain-based validation mechanism, ensuring
   authenticity and validity of information.  The design of chain-based
   validation ensures security of information during hop-by-hop
   propagation, preventing tampering by intermediate nodes or
   inconsistencies in policies from compromising end-to-end security.

   FC based on hop-by-hop verification mechanism, enables chain-based
   validation across multiple ASes.  Each FC generated by an AS can be
   independently verified without relying on updates from other ASes or
   cooperation from global network.  It also supports end-to-end
   verification across the entire network.  By constructing FC chains
   composed of multiple FCs between ASes, it can be used not only for
   individual hop-by-hop verification but also for building path chains
   that support global path validation, providing a foundation for end-
   to-end security.

   FC provides flexible propagation methods within FC-based framework,
   which can be achieved by extending existing BGP messages, proposing
   new propagation protocols, or leveraging existing network
   infrastructures such as RPKI for propagation.  This flexibility
   allows FC to be compatible with existing network infrastructures and
   enables gradual deployment and adoption.

3.  Forwarding Commitment

+--------------------+ +--------------------+ +--------------------+   \
| Route Announcement | |   Fowarding Path   | |   Routing Policy   |... >Operation
+--------------------+ +- ------------------+ +--------------------+   /
+---------------------------------------------------------------------+\
|                             BGP Peering                             | |
+---------------------------------------------------------------------+  >Topology
+---------------------------------------------------------------------+ |
|                            Link Statement                           | |
+---------------------------------------------------------------------+/

                     Figure 2: Example of FC-BGP.

   FC-BGP enhances the security of inter-domain routing and forwarding
   by building a publicly verifiable view of the forwarding commitments.
   At a high level, a routing commitment (FC) of an AS is a
   cryptographically-signed primitive that binds the AS's routing
   decisions (e.g. willing to forward traffic for a prefix via one of
   its directly-connected hops).  With this view, ASes are able to:

   1.  Evaluate the authenticity (or security) of the control plane BGP
       announcements based on committed routing decisions from relevant
       ASes.

   2.  Ensure that the dataplane forwarding is consistent with the
       routing decisions committed in the control plane.

   Upon receiving a BGP announcement, an upgraded AS generates a
   corresponding FC that contains the core information of the
   announcement, such as prefixes, sending AS, and receiving AS, and
   will be signed with the sender's private key for security.

4.  BGP Path Validation

   Consider an illustrative example using the four-AS topology shown in
   Figure 2.  In this process, FC-BGP generates the corresponding FC and
   propagates to downstream ASes (e.g., adding it to the Path Attributes
   of the BGP updates), so that the receiving AS can validate the
   authenticity of the announcement.  Suppose AS C receives a BGP
   announcement P(A): A->B->C from its neighbor B.  If AS C decides to
   further advertise this path to its neighbor D based on its routing
   policy, it generates a FC F(C,D,P), propagates it to AS D, and
   forwards the BGP update message to D.

   When AS D receives the route from C, it can determine the
   authenticity of the current AS path by verifying the list of FCs
   correctly reflects the AS path.

5.  Forwarding Validation

   AS shown in Figure 2, to enable forwarding validation, ASes need to
   announce the traffic-FCs binding relationships.  Specifically,
   suppose AS D confirms that the AS-path C->B->A for reaching prefix
   P(A) is legitimate, it binds the traffic (src:P(D),dst:P(A)) (where
   P(D) is the prefix owned by AS D) with the FC list F(C,D,P)-F(B,C,P)-
   F(A,B,P), and then publicly announces the binding relationship.

   Upon receiving the relationship, other ASes can build traffic
   filtering rules based on the relationship to enable forwarding
   validation on dataplane.  For instance, by interpreting the binding
   relationship produced by AS D, AS C confirms that the traffic
   (src:P(D), dst:P(A)) shall be forwarded over the link L(CD), and AS B
   confirms that the traffic shall be forwarded on link L(BC).  Network
   traffic violating these binding rules is considered to take
   unauthorized paths.

   To enable network-wide forwarding verification, these binding rules
   may be further broadcast globally (instead of just informing the ASes
   on the AS-path) so that off-path ASes can also discard unauthorized
   flows.

6.  Security Considerations

6.1.  Security Guarantees

   When FC-BGP used in conjunction with origin validation, the following
   security guarantees can be achieved:

   1.  The source AS in a route announcement is authorized.

   2.  FC-BGP speakers on the AS-Path are authorized to propagate the
       route announcements.

   3.  The forwarding path of packets is consistent with the routing
       path announced by the FC-BGP speakers.

   FC-BGP is designed to enhance the security of control plane routing
   and dataplane forwarding in the Internet at the network layer.
   Specifically, FC-BGP allows an AS to independently prove its BGP
   routing decisions with publicly verifiable cryptography commitments,
   based on which any on-path AS can verify the authenticity of a BGP
   path; meanwhile FC-BGP ensures the consistency between the control
   plane and dataplane, i.e., the network traffic shall take the
   forwarding path that is consistent with the control plane routing
   decisions, or otherwise be discarded.  More crucially, the above
   security guarantees offered by FC-BGP are not binary, i.e., secure or
   non-secure.  Instead, the security benefits are strictly
   monotonically increasing as the deployment rate of FC-BGP (i.e., the
   percentage of ASes that are upgraded to support FC-BGP) increases.

7.  IANA Considerations

   This document has no IANA actions.

8.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC4271]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A
              Border Gateway Protocol 4 (BGP-4)", RFC 4271,
              DOI 10.17487/RFC4271, January 2006,
              <https://www.rfc-editor.org/rfc/rfc4271>.

   [RFC6480]  Lepinski, M. and S. Kent, "An Infrastructure to Support
              Secure Internet Routing", RFC 6480, DOI 10.17487/RFC6480,
              February 2012, <https://www.rfc-editor.org/rfc/rfc6480>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8205]  Lepinski, M., Ed. and K. Sriram, Ed., "BGPsec Protocol
              Specification", RFC 8205, DOI 10.17487/RFC8205, September
              2017, <https://www.rfc-editor.org/rfc/rfc8205>.

   [RFC8209]  Reynolds, M., Turner, S., and S. Kent, "A Profile for
              BGPsec Router Certificates, Certificate Revocation Lists,
              and Certification Requests", RFC 8209,
              DOI 10.17487/RFC8209, September 2017,
              <https://www.rfc-editor.org/rfc/rfc8209>.

Acknowledgments

   TODO acknowledge.

Authors' Addresses

   Ke Xu
   Tsinghua University
   Beijing
   China
   Email: xuke@tsinghua.edu.cn


   Xiaoliang Wang
   Tsinghua University
   Beijing
   China
   Email: wangxiaoliang0623@foxmail.com


   Zhuotao liu
   Tsinghua University
   Beijing
   China
   Email: zhuotaoliu@tsinghua.edu.cn


   Li Qi
   Tsinghua University
   Beijing
   China
   Email: qli01@tsinghua.edu.cn


   Jianping Wu
   Tsinghua University
   Beijing
   China
   Email: jianping@cernet.edu.cn
